"use strict";(self["webpackChunkvue_vk_test"]=self["webpackChunkvue_vk_test"]||[]).push([[493],{2493:function(e,s,t){t.r(s),t.d(s,{default:function(){return Y}});var r=t(3396);const c={class:"home"};function n(e,s,t,n,i,a){const l=(0,r.up)("Search");return(0,r.wg)(),(0,r.iD)("div",c,[(0,r.Wm)(l)])}var i=t(9242),a=t(7139);const l=e=>((0,r.dD)("data-v-2a9bac32"),e=e(),(0,r.Cn)(),e),h={class:"search"},o={class:"search__wrapper"},d={key:0,class:"search__menu"},u={class:"search__container"},k={class:"search-list"},g=["onClick"],p=["onClick"],_=l((()=>(0,r._)("p",null,"Загрузить следующие 20 записей...",-1))),f=[_],U={key:0,class:"fetched-users"},w=l((()=>(0,r._)("p",null,"Найденные друзья выбранных пользователей:",-1))),m={class:"fetched-users__container"},v=["src"],C=["onClick"],y={key:1},I={key:1};function S(e,s,t,c,n,l){const _=(0,r.up)("my-input"),S=(0,r.up)("my-button"),D=(0,r.up)("my-loading-spinner");return(0,r.wg)(),(0,r.iD)("div",h,[this.isLoggedIn?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[(0,r._)("div",o,[this.getFetchedUsers?((0,r.wg)(),(0,r.iD)("div",d,[(0,r._)("div",u,[(0,r.Wm)(_,{modelValue:this.searchQuery,"onUpdate:modelValue":s[0]||(s[0]=e=>this.searchQuery=e),onInput:l.handleInput,onFocus:s[1]||(s[1]=()=>this.searchActive=!0),onFocusout:s[2]||(s[2]=()=>this.searchActive=!1)},null,8,["modelValue","onInput"]),(0,r.Wm)(S,{class:"search__button",onClick:l.clickSearchButtonHandler},{default:(0,r.w5)((()=>[(0,r.Uk)("Найти")])),_:1},8,["onClick"]),n.showSearchedUsers?((0,r.wg)(),(0,r.iD)("p",{key:0,class:"search__close-results",onClick:s[3]||(s[3]=(...e)=>l.closeSearchResults&&l.closeSearchResults(...e))},"Скрыть результаты...")):(0,r.wy)(((0,r.wg)(),(0,r.iD)("p",{key:1,class:"search__close-results",onClick:s[4]||(s[4]=(...e)=>l.openSearchResults&&l.openSearchResults(...e))}," Показать результаты...",512)),[[i.F8,0!==this.getFetchedUsers.length]])]),(0,r.wy)((0,r._)("div",k,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(this.getFetchedUsers,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e.id,class:"search-list__user",onClick:()=>l.userClickHandler(e)},[(0,r._)("p",null,[(0,r.Uk)("id: "),(0,r._)("span",{class:"profile-link",onClick:()=>this.clickProfileHandler(e)},(0,a.zw)(e.id),9,p)]),(0,r._)("p",null,(0,a.zw)(`${e.first_name} ${e.last_name}`),1),(0,r._)("p",null,"Общих друзей: "+(0,a.zw)(e.common_count),1)],8,g)))),128)),(0,r._)("div",{class:"search-list__next-users",onClick:s[5]||(s[5]=(...e)=>l.clickSearchNextUsers&&l.clickSearchNextUsers(...e))},f)],512),[[i.F8,n.showSearchedUsers]])])):(0,r.kq)("",!0)]),(0,r.Wm)(S,{class:"compute__button",onClick:l.clickComputeButtonHandler},{default:(0,r.w5)((()=>[(0,r.Uk)("Построить")])),_:1},8,["onClick"]),this.getIsLoading?((0,r.wg)(),(0,r.j4)(D,{key:1})):((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[0!==this.getFetchedCheckedUsersFriends.length?((0,r.wg)(),(0,r.iD)("div",U,[w,(0,r._)("div",m,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(this.getFetchedCheckedUsersFriends,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e.id,class:"user-card",style:(0,a.j5)({background:`hsl(120, ${Math.floor(e.countCheckedUserMatch/this.getCheckedUsers.length*100)}%, 50%)`})},[(0,r._)("img",{src:e.photo_200_orig,class:"user-card__avatar",alt:"Avatar"},null,8,v),(0,r._)("p",null,[(0,r.Uk)("ID: "),(0,r._)("span",{class:"profile-link",onClick:()=>this.clickProfileHandler(e)},(0,a.zw)(e.id),9,C)]),(0,r._)("p",null,(0,a.zw)(`${e.last_name} ${e.first_name}`),1),(0,r._)("p",null,"Возраст: "+(0,a.zw)(l.computeBDate(e.bdate)),1),(0,r._)("p",null,"Пол: "+(0,a.zw)(2===e.sex?"Мужчина":"Женщина"),1),(0,r._)("p",null,"Друзей: "+(0,a.zw)(e.friends_count),1)],4)))),128))])])):((0,r.wg)(),(0,r.iD)("p",y,'Выберите пользователей через поиск и нажмите кнопку "Построить"'))],64))],64)):((0,r.wg)(),(0,r.iD)("p",I,"Для начала войдите через ВК"))])}t(7658);var D=t(65),F=t(6115);const H={class:"my-input"};function L(e,s,t,c,n,i){return(0,r.wg)(),(0,r.iD)("input",H)}var b={name:"MyInput"},Q=t(89);const $=(0,Q.Z)(b,[["render",L],["__scopeId","data-v-7f8b9ff2"]]);var z=$;const M={class:"loader"};function B(e,s,t,c,n,i){return(0,r.wg)(),(0,r.iD)("div",M,"Loading...")}var x={name:"MyLoadingSpinner"};const A=(0,Q.Z)(x,[["render",B],["__scopeId","data-v-565f89f2"]]);var O=A,R={name:"SearchUsers",components:{MyLoadingSpinner:O,MyInput:z,MyButton:F.Z},data(){return{foundUsers:[],checkedUsersIds:[],searchActive:!1,searchQuery:"",showSearchedUsers:!1}},computed:{...(0,D.Se)(["getIsLoading","getUsersOffset","getAllUsers","getCheckedUsers","isLoggedIn","getLoggedUserId","getFetchedUsers","getFetchedCheckedUsersFriends"])},methods:{...(0,D.OI)(["setCheckedUsers","setUsersOffset","setProfile","setIsLoadingTrue","setIsLoadingFalse"]),...(0,D.nv)(["fetchCheckedUsersFriends","fetchUsers"]),clickProfileHandler(e){this.setProfile({userInfo:e}),this.$router.push({name:"profile",params:{id:e.id}})},handleInput(e){this.searchQuery=e.target.value},computeBDate(e){if(e){let s=e.split(".");if(3===s.length){const e=new Date(s[2],s[1]-1,s[0]);return Math.floor((Date.now()-e)/31536e6)}}return"Нет информации"},closeSearchResults(){this.showSearchedUsers=!1},openSearchResults(){this.showSearchedUsers=!0},findUsers(e){this.foundUsers=this.getAllUsers.filter((s=>s.name.toLowerCase().startsWith(e.toLowerCase())))},clickSearchButtonHandler(){this.setUsersOffset({offset:0}),this.fetchUsers({q:+this.searchQuery?`id${this.searchQuery}`:this.searchQuery}),this.showSearchedUsers=!0},clickSearchNextUsers(){this.setUsersOffset({offset:this.getUsersOffset+20}),this.fetchUsers({q:+this.searchQuery?`id${this.searchQuery}`:this.searchQuery})},async clickComputeButtonHandler(){0!==this.getCheckedUsers.length&&(this.setIsLoadingTrue(),await this.fetchCheckedUsersFriends({userIds:this.getCheckedUsers.map((e=>e.id))}),this.setIsLoadingFalse())},userClickHandler(e){const s=this.getCheckedUsers.findIndex((s=>s.id===e.id));let t=[...this.getCheckedUsers];-1===s?t.push({id:e.id,name:`${e.last_name} ${e.first_name}`}):t.splice(s,1),this.setCheckedUsers({checkedUsers:t})}}};const P=(0,Q.Z)(R,[["render",S],["__scopeId","data-v-2a9bac32"]]);var W=P,Z={name:"HomeView",components:{Search:W}};const V=(0,Q.Z)(Z,[["render",n]]);var Y=V}}]);
//# sourceMappingURL=493.01f1df46.js.map