(function(){"use strict";var e={2084:function(e,s,t){var r=t(9242),n=t(3396);function o(e,s,t,r,o,c){const i=(0,n.up)("NavPanel"),d=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(i),(0,n.Wm)(d)],64)}const c={class:"navbar"};function i(e,s,t,r,o,i){const d=(0,n.up)("router-link"),a=(0,n.up)("checked-users");return(0,n.wg)(),(0,n.iD)("div",c,[(0,n.Wm)(d,{to:"/"},{default:(0,n.w5)((()=>[(0,n.Uk)("Главная")])),_:1}),(0,n.Uk)(" | "),this.isLoggedIn?((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n._)("a",{href:"/",onClick:s[1]||(s[1]=(...e)=>i.clickExitHandler&&i.clickExitHandler(...e))},"Выйти"),(0,n.Wm)(a)],64)):((0,n.wg)(),(0,n.iD)("a",{key:0,href:"#",onClick:s[0]||(s[0]=(...e)=>i.loginHandler&&i.loginHandler(...e))},"Войти через ВК"))])}var d=t(65),a=t(7139);const f={class:"checked-users"},u={class:"checked-users__list"},l=["onClick"];function h(e,s,t,o,c,i){const d=(0,n.up)("my-button"),h=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",f,[(0,n.Wm)(d,{class:"checked-users__counter",onClick:i.handleClick},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(`Выбрано: ${this.getCheckedUsers.length}`),1)])),_:1},8,["onClick"]),(0,n.wy)((0,n._)("div",u,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(this.getCheckedUsers,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"checked-users__item",key:e.id},[(0,n._)("p",null,[(0,n.Wm)(h,{to:`/profile/${e.id}`},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e.id),1)])),_:2},1032,["to"])]),(0,n._)("p",null,(0,a.zw)(e.name),1),(0,n._)("button",{onClick:s=>i.clickDeleteUserHandler(e.id)},"x",8,l)])))),128))],512),[[r.F8,c.showCheckedUsers]])])}var p=t(6115),g={name:"CheckedUsers",components:{MyButton:p.Z},data(){return{showCheckedUsers:!1}},computed:{...(0,d.Se)(["getCheckedUsers"])},methods:{...(0,d.OI)(["setCheckedUsers"]),handleClick(){this.showCheckedUsers=!this.showCheckedUsers},clickDeleteUserHandler(e){const s=this.getCheckedUsers.findIndex((s=>s.id===e));let t=[...this.getCheckedUsers];t.splice(s,1),this.setCheckedUsers({checkedUsers:t})}}},k=t(89);const m=(0,k.Z)(g,[["render",h],["__scopeId","data-v-1c512aaa"]]);var v=m,U={name:"NavPanel",components:{CheckedUsers:v},beforeMount(){const e=window.location.hash;if(e.toString().includes("access_token")){const s=e.split("&")[0].slice(14),t=e.split("&")[2].slice(8);this.setAccessToken({token:s}),this.setLoggedUserId({userId:t})}},computed:{...(0,d.Se)(["isLoggedIn"])},methods:{...(0,d.OI)(["setAccessToken","setLoggedUserId","logout"]),...(0,d.nv)(["loginVK"]),loginHandler(){const e=51450674;this.loginVK({appId:e})},clickExitHandler(){this.logout()}}};const _=(0,k.Z)(U,[["render",i],["__scopeId","data-v-04c10460"]]);var y=_,w={components:{NavPanel:y}};const C=(0,k.Z)(w,[["render",o]]);var F=C,b=t(2483);const O=[{path:"/",name:"home",component:()=>t.e(493).then(t.bind(t,2493))},{path:"/profile/:id",name:"profile",component:()=>t.e(443).then(t.bind(t,2951))}],I=(0,b.p7)({history:(0,b.PO)("/vue-vk-test/"),routes:O});var T=I,L=(t(7658),t(7535)),E=t(2415);function P(e){return new Promise((s=>setTimeout(s,e)))}const W="http://localhost:8080";var x=(0,d.MT)({state:{isLoading:!1,searchQuery:"",checkedUsers:[],profile:null,accessToken:"",fetchedWall:[],loggedUserId:null,fetchedUsers:[],fetchedUserFriends:[],fetchedCheckedUsersFriends:[],usersOffset:0,userFriendsOffset:0,checkedUsersFriendsOffset:0,postOffset:0},getters:{getIsLoading:e=>e.isLoading,getSearchQuery:e=>e.searchQuery,getAllUsers:e=>e.users,getCheckedUsersFriendsOffset:e=>e.checkedUsersFriendsOffset,getPostOffset:e=>e.postOffset,getUsersOffset:e=>e.usersOffset,getUserFriendsOffset:e=>e.userFriendsOffset,getCheckedUsers:e=>e.checkedUsers,getFetchedUsers:e=>e.fetchedUsers,getFetchedUserFriends:e=>e.fetchedUserFriends,getFetchedCheckedUsersFriends:e=>e.fetchedCheckedUsersFriends,getFetchedWall:e=>e.fetchedWall,isLoggedIn:e=>!!e.accessToken,getProfile:e=>e.profile,getAccessToken:e=>e.accessToken,getLoggedUserId:e=>e.loggedUserId},mutations:{setIsLoadingTrue:e=>{console.log("Загрука началась!"),e.isLoading=!0},setIsLoadingFalse:e=>{console.log("Загрука закончилась!"),e.isLoading=!1},setAccessToken:(e,{token:s})=>{e.accessToken=s},setSearchQuery:(e,{q:s})=>{e.searchQuery=s},setUsersOffset:(e,{offset:s})=>{e.usersOffset=s},setUserFriendsOffset:(e,{offset:s})=>{e.userFriendsOffset=s},setCheckedUsersOffset:(e,{offset:s})=>{e.checkedUsersFriendsOffset=s},setPostOffset:(e,{offset:s})=>{e.postOffset=s},setUsers:(e,{users:s})=>{e.users=s},setCheckedUsers:(e,{checkedUsers:s})=>{e.checkedUsers=s},setFetchedUsers:(e,{fetchedUsers:s})=>{e.fetchedUsers=s},setFetchedUserFriends:(e,{fetchedUserFriends:s})=>{e.fetchedUserFriends=s},setFetchedCheckedUsersFriends:(e,{fetchedCheckedUsersFriends:s})=>{e.fetchedCheckedUsersFriends=s},setFetchedWall:(e,{fetchedWall:s})=>{e.fetchedWall=s},setProfile:(e,{userInfo:s})=>{console.log(s),e.profile=s},setLoggedUserId:(e,{userId:s})=>{e.loggedUserId=s},logout:e=>{e.isLoading=!1,e.checkedUsers=[],e.profile=null,e.accessToken="",e.fetchedWall=[],e.loggedUserId=null,e.fetchedUsers=[],e.fetchedUserFriends=[],e.fetchedCheckedUsersFriends=[],e.usersOffset=0,e.checkedUsersFriendsOffset=0,e.postOffset=0}},actions:{loginVK:async(e,{appId:s})=>{window.location.href=`https://oauth.vk.com/authorize?client_id=${s}&display=popup&redirect_uri=${W}&scope=friends&users&response_type=token&v=v=5.131`},fetchUsers:async(e,{q:s})=>{try{const t=await(0,L.R)("https://api.vk.com/method/users.search",{q:s,access_token:e.state.accessToken,count:"20",offset:e.state.usersOffset,fields:"name,common_count,sex,photo",v:5.131}),r=t.response.items;await P(200),0===e.state.usersOffset?e.commit("setFetchedUsers",{fetchedUsers:r}):e.commit("setFetchedUsers",{fetchedUsers:[...e.state.fetchedUsers,...r]})}catch(t){console.log(t)}},fetchUserFriends:async(e,{userIds:s})=>{try{let t=[];for(const r of s){const s=await(0,L.R)("https://api.vk.com/method/users.get",{user_id:r,fields:"name,sex,photo,bdate,counters",access_token:e.state.accessToken,offset:e.state.userFriendsOffset,v:5.131});await P(200),s.error||t.push(s.response[0])}e.commit("setFetchedUserFriends",{fetchedUserFriends:t})}catch(t){console.log(t)}},fetchCheckedUsersFriends:async(e,{userIds:s})=>{try{let t=[],r=[],n={};for(const o of s){const s=await(0,L.R)("https://api.vk.com/method/friends.get",{user_id:o,fields:"name,photo_200_orig,bdate,sex,list_id",access_token:e.state.accessToken,v:5.131});if(!s.error){for(const e of s.response.items)e["checkedUserId"]=o;t=[...t,...s.response.items],console.log(s.response.items)}}t.forEach((e=>{n[e.id]?n[e.id]=[...n[e.id],e.checkedUserId]:n[e.id]=[e.checkedUserId]})),t.forEach((e=>{n[e.id]&&"DELETED"!==e.first_name&&e.can_access_closed&&!e.is_closed&&(e.countCheckedUserMatch=n[e.id].length,e.checkedUserInFriends=n[e.id],r.push(e),delete n[e.id])})),r.sort(((e,s)=>e.last_name.toLowerCase().localeCompare(s.last_name.toLowerCase())));for(const s of r){const t=await(0,L.R)("https://api.vk.com/method/users.get",{user_ids:s.id,access_token:e.state.accessToken,fields:"counters",v:5.131});await P(300),t.error?s["friends_count"]="Нет информации...":s["friends_count"]=t.response[0].counters.friends}await P(200),e.commit("setFetchedCheckedUsersFriends",{fetchedCheckedUsersFriends:r})}catch(t){console.log(t)}},fetchUserWall:async(e,{userId:s})=>{try{const t=await(0,L.R)("https://api.vk.com/method/wall.get",{owner_id:s,access_token:e.state.accessToken,v:5.131}),r=t.response.items;await P(200),e.commit("setFetchedWall",{fetchedWall:r})}catch(t){console.log(t)}},fetchProfile:async(e,{userId:s})=>{try{const t=await(0,L.R)("https://api.vk.com/method/users.get",{user_ids:s,access_token:e.state.accessToken,fields:"name,sex,photo_200_orig,bdate,counters",v:5.131}),r=t.response[0];await P(200),e.commit("setProfile",{userInfo:r})}catch(t){console.log(t)}}},modules:{},plugins:[(0,E.Z)()]});(0,r.ri)(F).use(x).use(T).mount("#app")},6115:function(e,s,t){t.d(s,{Z:function(){return a}});var r=t(3396);const n={class:"my-button"};function o(e,s,t,o,c,i){return(0,r.wg)(),(0,r.iD)("button",n,[(0,r.WI)(e.$slots,"default",{},void 0,!0)])}var c={name:"MyButton"},i=t(89);const d=(0,i.Z)(c,[["render",o],["__scopeId","data-v-2fdc280c"]]);var a=d}},s={};function t(r){var n=s[r];if(void 0!==n)return n.exports;var o=s[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.m=e,function(){var e=[];t.O=function(s,r,n,o){if(!r){var c=1/0;for(f=0;f<e.length;f++){r=e[f][0],n=e[f][1],o=e[f][2];for(var i=!0,d=0;d<r.length;d++)(!1&o||c>=o)&&Object.keys(t.O).every((function(e){return t.O[e](r[d])}))?r.splice(d--,1):(i=!1,o<c&&(c=o));if(i){e.splice(f--,1);var a=n();void 0!==a&&(s=a)}}return s}o=o||0;for(var f=e.length;f>0&&e[f-1][2]>o;f--)e[f]=e[f-1];e[f]=[r,n,o]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})}}(),function(){t.f={},t.e=function(e){return Promise.all(Object.keys(t.f).reduce((function(s,r){return t.f[r](e,s),s}),[]))}}(),function(){t.u=function(e){return"js/"+(443===e?"about":e)+"."+{443:"c88594a8",493:"01f1df46"}[e]+".js"}}(),function(){t.miniCssF=function(e){return"css/"+(443===e?"about":e)+"."+{443:"ca42e99d",493:"e1b53ac1"}[e]+".css"}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){var e={},s="vue-vk-test:";t.l=function(r,n,o,c){if(e[r])e[r].push(n);else{var i,d;if(void 0!==o)for(var a=document.getElementsByTagName("script"),f=0;f<a.length;f++){var u=a[f];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==s+o){i=u;break}}i||(d=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,t.nc&&i.setAttribute("nonce",t.nc),i.setAttribute("data-webpack",s+o),i.src=r),e[r]=[n];var l=function(s,t){i.onerror=i.onload=null,clearTimeout(h);var n=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((function(e){return e(t)})),s)return s(t)},h=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),d&&document.head.appendChild(i)}}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/vue-vk-test/"}(),function(){var e=function(e,s,t,r){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var o=function(o){if(n.onerror=n.onload=null,"load"===o.type)t();else{var c=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.href||s,d=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");d.code="CSS_CHUNK_LOAD_FAILED",d.type=c,d.request=i,n.parentNode.removeChild(n),r(d)}};return n.onerror=n.onload=o,n.href=s,document.head.appendChild(n),n},s=function(e,s){for(var t=document.getElementsByTagName("link"),r=0;r<t.length;r++){var n=t[r],o=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(o===e||o===s))return n}var c=document.getElementsByTagName("style");for(r=0;r<c.length;r++){n=c[r],o=n.getAttribute("data-href");if(o===e||o===s)return n}},r=function(r){return new Promise((function(n,o){var c=t.miniCssF(r),i=t.p+c;if(s(c,i))return n();e(r,i,n,o)}))},n={143:0};t.f.miniCss=function(e,s){var t={443:1,493:1};n[e]?s.push(n[e]):0!==n[e]&&t[e]&&s.push(n[e]=r(e).then((function(){n[e]=0}),(function(s){throw delete n[e],s})))}}(),function(){var e={143:0};t.f.j=function(s,r){var n=t.o(e,s)?e[s]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise((function(t,r){n=e[s]=[t,r]}));r.push(n[2]=o);var c=t.p+t.u(s),i=new Error,d=function(r){if(t.o(e,s)&&(n=e[s],0!==n&&(e[s]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),c=r&&r.target&&r.target.src;i.message="Loading chunk "+s+" failed.\n("+o+": "+c+")",i.name="ChunkLoadError",i.type=o,i.request=c,n[1](i)}};t.l(c,d,"chunk-"+s,s)}},t.O.j=function(s){return 0===e[s]};var s=function(s,r){var n,o,c=r[0],i=r[1],d=r[2],a=0;if(c.some((function(s){return 0!==e[s]}))){for(n in i)t.o(i,n)&&(t.m[n]=i[n]);if(d)var f=d(t)}for(s&&s(r);a<c.length;a++)o=c[a],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(f)},r=self["webpackChunkvue_vk_test"]=self["webpackChunkvue_vk_test"]||[];r.forEach(s.bind(null,0)),r.push=s.bind(null,r.push.bind(r))}();var r=t.O(void 0,[998],(function(){return t(2084)}));r=t.O(r)})();
//# sourceMappingURL=app.c0d606fb.js.map