(function(){"use strict";var e={799:function(e,t,s){var r=s(9242),n=s(3396);function o(e,t,s,r,o,c){const i=(0,n.up)("NavPanel"),d=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(i),(0,n.Wm)(d)],64)}const c={class:"navbar"};function i(e,t,s,r,o,i){const d=(0,n.up)("router-link"),a=(0,n.up)("checked-users");return(0,n.wg)(),(0,n.iD)("div",c,[(0,n.Wm)(d,{to:"/"},{default:(0,n.w5)((()=>[(0,n.Uk)("Главная")])),_:1}),(0,n.Uk)(" | "),this.isLoggedIn?((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n._)("a",{href:"/",onClick:t[1]||(t[1]=(...e)=>i.clickExitHandler&&i.clickExitHandler(...e))},"Выйти"),(0,n.Wm)(a)],64)):((0,n.wg)(),(0,n.iD)("a",{key:0,href:"#",onClick:t[0]||(t[0]=(...e)=>i.loginHandler&&i.loginHandler(...e))},"Войти через ВК"))])}var d=s(65),a=s(7139);const f={class:"checked-users"},u={class:"checked-users__list"},l=["onClick"];function h(e,t,s,o,c,i){const d=(0,n.up)("my-button"),h=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",f,[(0,n.Wm)(d,{class:"checked-users__counter",onClick:i.handleClick},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(`Выбрано: ${this.getCheckedUsers.length}`),1)])),_:1},8,["onClick"]),(0,n.wy)((0,n._)("div",u,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(this.getCheckedUsers,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"checked-users__item",key:e.id},[(0,n._)("p",null,[(0,n.Wm)(h,{to:`/profile/${e.id}`},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e.id),1)])),_:2},1032,["to"])]),(0,n._)("p",null,(0,a.zw)(e.name),1),(0,n._)("button",{onClick:t=>i.clickDeleteUserHandler(e.id)},"x",8,l)])))),128))],512),[[r.F8,c.showCheckedUsers]])])}var p=s(6115),k={name:"CheckedUsers",components:{MyButton:p.Z},data(){return{showCheckedUsers:!1}},computed:{...(0,d.Se)(["getCheckedUsers"])},methods:{...(0,d.OI)(["setCheckedUsers"]),handleClick(){this.showCheckedUsers=!this.showCheckedUsers},clickDeleteUserHandler(e){const t=this.getCheckedUsers.findIndex((t=>t.id===e));let s=[...this.getCheckedUsers];s.splice(t,1),this.setCheckedUsers({checkedUsers:s})}}},m=s(89);const g=(0,m.Z)(k,[["render",h],["__scopeId","data-v-1c512aaa"]]);var v=g,U={name:"NavPanel",components:{CheckedUsers:v},beforeMount(){const e=window.location.hash;if(e.toString().includes("access_token")){const t=e.split("&")[0].slice(14),s=e.split("&")[2].slice(8);this.setAccessToken({token:t}),this.setLoggedUserId({userId:s})}},computed:{...(0,d.Se)(["isLoggedIn"])},methods:{...(0,d.OI)(["setAccessToken","setLoggedUserId","logout"]),...(0,d.nv)(["loginVK"]),loginHandler(){const e=51450674;this.loginVK({appId:e})},clickExitHandler(){this.logout()}}};const F=(0,m.Z)(U,[["render",i],["__scopeId","data-v-04c10460"]]);var _=F,y={components:{NavPanel:_}};const C=(0,m.Z)(y,[["render",o]]);var w=C,b=s(2483);const O=[{path:"/",name:"home",component:()=>s.e(226).then(s.bind(s,9226))},{path:"/profile/:id",name:"profile",component:()=>s.e(443).then(s.bind(s,4055))}],I=(0,b.p7)({history:(0,b.PO)("/"),routes:O});var T=I,E=(s(7658),s(7535)),P=s(2415);const W="http://localhost:8080";var L=(0,d.MT)({state:{searchQuery:"",checkedUsers:[],profile:null,accessToken:"",fetchedWall:[],loggedUserId:null,fetchedUsers:[],fetchedUserFriends:[],fetchedCheckedUsersFriends:[],usersOffset:0,userFriendsOffset:0,checkedUsersFriendsOffset:0,postOffset:0},getters:{getSearchQuery:e=>e.searchQuery,getAllUsers:e=>e.users,getCheckedUsersFriendsOffset:e=>e.checkedUsersFriendsOffset,getPostOffset:e=>e.postOffset,getUsersOffset:e=>e.usersOffset,getUserFriendsOffset:e=>e.userFriendsOffset,getCheckedUsers:e=>e.checkedUsers,getFetchedUsers:e=>e.fetchedUsers,getFetchedUserFriends:e=>e.fetchedUserFriends,getFetchedCheckedUsersFriends:e=>e.fetchedCheckedUsersFriends,getFetchedWall:e=>e.fetchedWall,isLoggedIn:e=>!!e.accessToken,getProfile:e=>e.profile,getAccessToken:e=>e.accessToken,getLoggedUserId:e=>e.loggedUserId},mutations:{setAccessToken:(e,{token:t})=>{e.accessToken=t},setSearchQuery:(e,{q:t})=>{e.searchQuery=t},setUsersOffset:(e,{offset:t})=>{e.usersOffset=t},setUserFriendsOffset:(e,{offset:t})=>{e.userFriendsOffset=t},setCheckedUsersOffset:(e,{offset:t})=>{e.checkedUsersFriendsOffset=t},setPostOffset:(e,{offset:t})=>{e.postOffset=t},setUsers:(e,{users:t})=>{e.users=t},setCheckedUsers:(e,{checkedUsers:t})=>{e.checkedUsers=t},setFetchedUsers:(e,{fetchedUsers:t})=>{e.fetchedUsers=t},setFetchedUserFriends:(e,{fetchedUserFriends:t})=>{e.fetchedUserFriends=t},setFetchedCheckedUsersFriends:(e,{fetchedCheckedUsersFriends:t})=>{e.fetchedCheckedUsersFriends=t},setFetchedWall:(e,{fetchedWall:t})=>{e.fetchedWall=t},setProfile:(e,{userInfo:t})=>{e.profile=t},setLoggedUserId:(e,{userId:t})=>{e.loggedUserId=t},logout:e=>{e.checkedUsers=[],e.profile=null,e.accessToken="",e.fetchedWall=[],e.loggedUserId=null,e.fetchedUsers=[],e.fetchedUserFriends=[],e.fetchedCheckedUsersFriends=[],e.usersOffset=0,e.checkedUsersFriendsOffset=0,e.postOffset=0}},actions:{loginVK:async(e,{appId:t})=>{window.location.href=`https://oauth.vk.com/authorize?client_id=${t}&display=popup&redirect_uri=${W}&scope=friends&users&response_type=token&v=v=5.131`},fetchUsers:async(e,{q:t})=>{console.log(e.state.usersOffset);const s=await(0,E.R)("https://api.vk.com/method/users.search",{q:t,access_token:e.state.accessToken,count:"20",offset:e.state.usersOffset,fields:"name,common_count,sex,photo",v:5.131}),r=s.response.items;0===e.state.usersOffset?e.commit("setFetchedUsers",{fetchedUsers:r}):e.commit("setFetchedUsers",{fetchedUsers:[...e.state.fetchedUsers,...r]})},fetchUserFriends:async(e,{userId:t})=>{const s=await(0,E.R)("https://api.vk.com/method/friends.get",{user_id:t,fields:"name,photo,bdate,common_count,sex",access_token:e.state.accessToken,count:"20",offset:e.state.userFriendsOffset,v:5.131});if(0!==s.response.items.length){const t=s.response.items;0===e.state.usersOffset?e.commit("setFetchedUserFriends",{fetchedUserFriends:t}):e.commit("setFetchedUserFriends",{fetchedUserFriends:[...e.state.fetchedUserFriends,...t]})}},fetchCheckedUsersFriends:async(e,{userIds:t})=>{function s(e){return new Promise((t=>setTimeout(t,e)))}let r=[],n=[],o={};for(const c of t){const t=await(0,E.R)("https://api.vk.com/method/friends.get",{user_id:c,fields:"name,photo_200_orig,bdate,sex",access_token:e.state.accessToken,v:5.131});t.error||(r=[...r,...t.response.items]),await s(400)}r.forEach((e=>{o[e.id]?o[e.id]+=1:o[e.id]=1})),r.forEach((e=>{o[e.id]&&"DELETED"!==e.first_name&&(e.countCheckedUserMatch=o[e.id],n.push(e),delete o[e.id])})),n.sort(((e,t)=>e.last_name.toLowerCase().localeCompare(t.last_name.toLowerCase()))),e.commit("setFetchedCheckedUsersFriends",{fetchedCheckedUsersFriends:n})},fetchUserWall:async(e,{userId:t})=>{const s=await(0,E.R)("https://api.vk.com/method/wall.get",{owner_id:t,access_token:e.state.accessToken,v:5.131}),r=s.response.items;e.commit("setFetchedWall",{fetchedWall:r})},fetchProfile:async(e,{userId:t})=>{const s=await(0,E.R)("https://api.vk.com/method/users.get",{user_ids:t,access_token:e.state.accessToken,fields:"name,sex,photo_200_orig,bdate,counters",v:5.131}),r=s.response[0];e.commit("setProfile",{userInfo:r})}},modules:{},plugins:[(0,P.Z)()]});(0,r.ri)(w).use(L).use(T).mount("#app")},6115:function(e,t,s){s.d(t,{Z:function(){return a}});var r=s(3396);const n={class:"my-button"};function o(e,t,s,o,c,i){return(0,r.wg)(),(0,r.iD)("button",n,[(0,r.WI)(e.$slots,"default",{},void 0,!0)])}var c={name:"MyButton"},i=s(89);const d=(0,i.Z)(c,[["render",o],["__scopeId","data-v-2fdc280c"]]);var a=d}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,r,n,o){if(!r){var c=1/0;for(f=0;f<e.length;f++){r=e[f][0],n=e[f][1],o=e[f][2];for(var i=!0,d=0;d<r.length;d++)(!1&o||c>=o)&&Object.keys(s.O).every((function(e){return s.O[e](r[d])}))?r.splice(d--,1):(i=!1,o<c&&(c=o));if(i){e.splice(f--,1);var a=n();void 0!==a&&(t=a)}}return t}o=o||0;for(var f=e.length;f>0&&e[f-1][2]>o;f--)e[f]=e[f-1];e[f]=[r,n,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,r){return s.f[r](e,t),t}),[]))}}(),function(){s.u=function(e){return"js/"+(443===e?"about":e)+"."+{226:"3a111ba4",443:"77fad1d8"}[e]+".js"}}(),function(){s.miniCssF=function(e){return"css/"+(443===e?"about":e)+"."+{226:"34a789c7",443:"051e7eac"}[e]+".css"}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="vue-vk-test:";s.l=function(r,n,o,c){if(e[r])e[r].push(n);else{var i,d;if(void 0!==o)for(var a=document.getElementsByTagName("script"),f=0;f<a.length;f++){var u=a[f];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+o){i=u;break}}i||(d=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.setAttribute("data-webpack",t+o),i.src=r),e[r]=[n];var l=function(t,s){i.onerror=i.onload=null,clearTimeout(h);var n=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((function(e){return e(s)})),t)return t(s)},h=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),d&&document.head.appendChild(i)}}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.p="/"}(),function(){var e=function(e,t,s,r){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var o=function(o){if(n.onerror=n.onload=null,"load"===o.type)s();else{var c=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.href||t,d=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");d.code="CSS_CHUNK_LOAD_FAILED",d.type=c,d.request=i,n.parentNode.removeChild(n),r(d)}};return n.onerror=n.onload=o,n.href=t,document.head.appendChild(n),n},t=function(e,t){for(var s=document.getElementsByTagName("link"),r=0;r<s.length;r++){var n=s[r],o=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(o===e||o===t))return n}var c=document.getElementsByTagName("style");for(r=0;r<c.length;r++){n=c[r],o=n.getAttribute("data-href");if(o===e||o===t)return n}},r=function(r){return new Promise((function(n,o){var c=s.miniCssF(r),i=s.p+c;if(t(c,i))return n();e(r,i,n,o)}))},n={143:0};s.f.miniCss=function(e,t){var s={226:1,443:1};n[e]?t.push(n[e]):0!==n[e]&&s[e]&&t.push(n[e]=r(e).then((function(){n[e]=0}),(function(t){throw delete n[e],t})))}}(),function(){var e={143:0};s.f.j=function(t,r){var n=s.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise((function(s,r){n=e[t]=[s,r]}));r.push(n[2]=o);var c=s.p+s.u(t),i=new Error,d=function(r){if(s.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),c=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+c+")",i.name="ChunkLoadError",i.type=o,i.request=c,n[1](i)}};s.l(c,d,"chunk-"+t,t)}},s.O.j=function(t){return 0===e[t]};var t=function(t,r){var n,o,c=r[0],i=r[1],d=r[2],a=0;if(c.some((function(t){return 0!==e[t]}))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(d)var f=d(s)}for(t&&t(r);a<c.length;a++)o=c[a],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(f)},r=self["webpackChunkvue_vk_test"]=self["webpackChunkvue_vk_test"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=s.O(void 0,[998],(function(){return s(799)}));r=s.O(r)})();
//# sourceMappingURL=app.c3ed4745.js.map